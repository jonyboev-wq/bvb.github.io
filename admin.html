<!DOCTYPE html>
<html lang="ru" data-theme="">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>–ê–¥–º–∏–Ω–∫–∞ ‚Äî BVB</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#f7fafc;--bg-2:#ffffff;--card:#ffffff;--muted:#5b6776;--text:#0b1220;--accent:#2563eb;--border:#e5e7eb;--shadow:0 10px 24px rgba(16,24,40,.08);--radius:16px;--maxw:1100px}
[data-theme="dark"]{--bg:#0b1220;--bg-2:#0e1729;--card:#111a2e;--muted:#9fb0c8;--text:#e6eef9;--accent:#3b82f6;--border:#1d2a44;--shadow:0 12px 34px rgba(0,0,0,.35)}
*{box-sizing:border-box} html,body{margin:0;padding:0}
body{font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text);line-height:1.6}
.container{max-width:var(--maxw);margin:0 auto;padding:16px}
header{position:sticky;top:0;background:var(--bg-2);border-bottom:1px solid var(--border);backdrop-filter:saturate(160%) blur(8px);z-index:10}
[data-theme="dark"] header{background:rgba(14,23,41,.9)}
.nav{display:flex;justify-content:space-between;align-items:center;gap:8px}
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border:1px solid var(--border);border-radius:12px;background:var(--bg-2);cursor:pointer;color:var(--text)}
.btn.primary{background:linear-gradient(180deg,var(--accent),#1d4ed8);border:none;color:#fff}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:16px;margin-top:12px}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media (max-width:760px){.grid2{grid-template-columns:1fr}}
input,textarea{width:100%;padding:12px;background:var(--bg-2);border:1px solid var(--border);border-radius:12px;color:var(--text);font:inherit}
textarea{min-height:110px}
.muted{color:var(--muted);font-size:13px}
.row{display:flex;gap:8px;flex-wrap:wrap}
.prod{margin-top:10px}
.login{min-height:100dvh;display:grid;place-items:center}
.login .box{width:min(420px,95%);background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:18px}
</style>
</head>
<body>
<header class="container nav">
  <div class="row">
    <a class="btn" href="index.html">‚Üê –ù–∞ —Å–∞–π—Ç</a>
    <button class="btn" id="theme-toggle">üåô –¢–µ–º–∞</button>
  </div>
  <div class="row">
    <button class="btn" id="export">–≠–∫—Å–ø–æ—Ä—Ç JSON</button>
    <label class="btn">–ò–º–ø–æ—Ä—Ç JSON<input id="import" type="file" accept="application/json" style="display:none"></label>
    <button class="btn primary" id="save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å (localStorage)</button>
    <button class="btn" id="logout">–í—ã–π—Ç–∏</button>
  </div>
</header>

<main class="container" id="root" style="display:none">
  <h1 style="margin:6px 0 14px">–ê–¥–º–∏–Ω–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞</h1>
  <p class="muted">–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —É –≤–∞—Å –≤ –±—Ä–∞—É–∑–µ—Ä–µ (localStorage). –ß—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Ö –¥–ª—è –≤—Å–µ—Ö, –Ω–∞–∂–º–∏—Ç–µ ¬´–≠–∫—Å–ø–æ—Ä—Ç JSON¬ª –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∫–∞–∫ <code>shopConfig.json</code> –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.</p>

  <section class="card">
    <h2 style="margin:0 0 10px">–î–∞–Ω–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω–∞</h2>
    <div class="grid2">
      <div><label>–ù–∞–∑–≤–∞–Ω–∏–µ<input id="name"></label></div>
      <div><label>–°–ª–æ–≥–∞–Ω<input id="tag"></label></div>
      <div><label>Email<input id="email"></label></div>
      <div><label>–¢–µ–ª–µ—Ñ–æ–Ω<input id="phone"></label></div>
      <div><label>–ò–ù–ù<input id="inn"></label></div>
      <div><label>–û–ì–†–ù<input id="ogrn"></label></div>
    </div>
  </section>

  <section class="card">
    <h2 style="margin:0 0 10px">–°–æ—Ü—Å–µ—Ç–∏</h2>
    <div id="socials"></div>
    <button class="btn" id="add-social" style="margin-top:8px">–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ü—Å–µ—Ç—å</button>
    <p class="muted">–ü–æ–ª—è: label (–Ω–∞–∑–≤–∞–Ω–∏–µ), url (—Å—Å—ã–ª–∫–∞), icon (telegram/whatsapp/avito).</p>
  </section>

  <section class="card">
    <h2 style="margin:0 0 10px">Telegram –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</h2>
    <div class="grid2">
      <div><label>Token –±–æ—Ç–∞<input id="tg-token" placeholder="1234:ABC..."></label></div>
      <div><label>Chat ID<input id="tg-chat" placeholder="123456789"></label></div>
    </div>
    <p class="muted">–ï—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –∑–∞–∫–∞–∑ –ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.</p>
  </section>

  <section class="card">
    <h2 style="margin:0 0 6px">–¢–æ–≤–∞—Ä—ã</h2>
    <div id="products"></div>
    <button class="btn" id="add-product" style="margin-top:8px">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
    <p class="muted">ID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º. <b>price</b> (—á–∏—Å–ª–æ) –∏/–∏–ª–∏ <b>priceText</b> (—Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä. ¬´2 990 ‚ÇΩ¬ª).</p>
  </section>
</main>

<!-- Login -->
<div id="login" class="login">
  <div class="box">
    <h2 style="margin:0 0 8px">–í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω–∫—É</h2>
    <p class="muted">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –¥–ª—è –∞–¥–º–∏–Ω–∫–∏.</p>
    <input id="pwd" type="password" placeholder="–ü–∞—Ä–æ–ª—å" style="margin-top:8px">
    <div class="row" style="margin-top:10px">
      <button class="btn primary" id="go">–í–æ–π—Ç–∏</button>
    </div>
    <p class="muted" style="margin-top:12px">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–∞—Ä–æ–ª—å <code>bvbadmin</code>. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–º–µ–Ω–∏—Ç—å: —Å–º. –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ –∫–æ–¥–µ (ADMIN_PWD_HASH).</p>
  </div>
</div>

<script>
/* ===== –¢–ï–ú–ê ===== */
const applyTheme=(t)=>{const el=document.documentElement;if(!t){t=localStorage.getItem('theme')||(matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light');}el.setAttribute('data-theme',t==='dark'?'dark':'');localStorage.setItem('theme',t);}
applyTheme(); document.getElementById('theme-toggle').onclick=()=>applyTheme(document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark');

/* ===== –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è) =====
  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–≤–æ–π –ø–∞—Ä–æ–ª—å –∏ –∑–∞–º–µ–Ω–∏—Ç–µ ADMIN_PWD_HASH.
  –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å SHA-256:
    1) –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ö–æ–Ω—Å–æ–ª—å.
    2) –í—Å—Ç–∞–≤—å—Ç–µ:
       const d = new TextEncoder().encode('–í–ê–®_–ü–ê–†–û–õ–¨');
       crypto.subtle.digest('SHA-256', d).then(b=>console.log(Array.from(new Uint8Array(b)).map(x=>x.toString(16).padStart(2,'0')).join('')));
    3) –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –Ω–∏–∂–µ –≤–º–µ—Å—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è.
*/
const ADMIN_PWD_HASH = "f2176fa29ce05cc5610886d35562d655feee636e50770537202443dc7cbbedde"; // sha256('bvbadmin') –ü–†–ò–ú–ï–†!
async function sha256(s){const enc=new TextEncoder().encode(s);const b=await crypto.subtle.digest('SHA-256',enc);return Array.from(new Uint8Array(b)).map(x=>x.toString(16).padStart(2,'0')).join('');}
function ok(){localStorage.setItem('admin_ok','1'); document.getElementById('login').style.display='none'; document.getElementById('root').style.display='';}
if(localStorage.getItem('admin_ok')==='1'){ ok(); }
document.getElementById('go').onclick=async()=>{ const p=document.getElementById('pwd').value; if(!p) return; if(await sha256(p)===ADMIN_PWD_HASH){ ok(); } else { alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å'); } };
document.getElementById('logout').onclick=()=>{ localStorage.removeItem('admin_ok'); location.reload(); };

/* ===== –ö–æ–Ω—Ñ–∏–≥ ===== */
const DEF={name:'BVB',tag:'–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞',email:'sales@example.com',phone:'+7 (900) 000-00-00',inn:'',ogrn:'',socials:[],telegram:null,products:[]};
let CONFIG={...DEF};
async function load(){
  try{const r=await fetch('shopConfig.json',{cache:'no-store'}); if(r.ok){CONFIG={...CONFIG,...await r.json()};}}catch(e){}
  const loc=localStorage.getItem('shopConfig'); if(loc){ try{CONFIG={...CONFIG,...JSON.parse(loc)};}catch(e){} }
}
const $=(s,el=document)=>el.querySelector(s); const cEl=(t,cls)=>{const e=document.createElement(t); if(cls) e.className=cls; return e;}

function renderStore(){
  $('#name').value=CONFIG.name||''; $('#tag').value=CONFIG.tag||''; $('#email').value=CONFIG.email||'';
  $('#phone').value=CONFIG.phone||''; $('#inn').value=CONFIG.inn||''; $('#ogrn').value=CONFIG.ogrn||'';
  $('#tg-token').value=CONFIG.telegram?.token||''; $('#tg-chat').value=CONFIG.telegram?.chat_id||'';

  const wrapS=$('#socials'); wrapS.innerHTML='';
  (CONFIG.socials||[]).forEach((s,i)=>{
    const row=cEl('div','grid2'); row.style.marginTop='8px';
    row.innerHTML=`
      <div><label>label<input data-f="label" value="${s.label||''}"></label></div>
      <div><label>url<input data-f="url" value="${s.url||''}"></label></div>
      <div><label>icon<input data-f="icon" value="${s.icon||''}" placeholder="telegram/whatsapp/avito"></label></div>
      <div class="row"><button class="btn" data-save>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button><button class="btn" data-del>–£–¥–∞–ª–∏—Ç—å</button></div>`;
    row.querySelector('[data-save]').onclick=()=>{ s.label=row.querySelector('[data-f="label"]').value.trim(); s.url=row.querySelector('[data-f="url"]').value.trim(); s.icon=row.querySelector('[data-f="icon"]').value.trim(); };
    row.querySelector('[data-del]').onclick=()=>{ if(confirm('–£–¥–∞–ª–∏—Ç—å —Å–æ—Ü—Å–µ—Ç—å?')){ CONFIG.socials.splice(i,1); renderStore(); } };
    wrapS.appendChild(row);
  });
  $('#add-social').onclick=()=>{ CONFIG.socials.push({label:'',url:'',icon:''}); renderStore(); };
}

function renderProducts(){
  const wrap=$('#products'); wrap.innerHTML='';
  (CONFIG.products||[]).forEach((p,idx)=>{
    const box=cEl('div','card prod'); 
    box.innerHTML=`
      <div class="grid2">
        <div><label>–ù–∞–∑–≤–∞–Ω–∏–µ<input data-f="title" value="${p.title||''}"></label></div>
        <div><label>ID<input data-f="id" value="${p.id||('id-'+idx)}"></label></div>
        <div><label>–¶–µ–Ω–∞ (—á–∏—Å–ª–æ)<input type="number" data-f="price" value="${p.price||0}"></label></div>
        <div><label>–¶–µ–Ω–∞ (—Ç–µ–∫—Å—Ç)<input data-f="priceText" value="${p.priceText||''}" placeholder="–Ω–∞–ø—Ä. 2 990 ‚ÇΩ"></label></div>
        <div><label>–¢—ç–≥<input data-f="tag" value="${p.tag||''}"></label></div>
        <div><label>URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è<input data-f="img" value="${p.img||''}"></label></div>
      </div>
      <div style="margin-top:8px"><label>–û–ø–∏—Å–∞–Ω–∏–µ<textarea data-f="desc">${p.desc||''}</textarea></label></div>
      <div class="row" style="margin-top:8px">
        <button class="btn" data-save>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="btn" data-del>–£–¥–∞–ª–∏—Ç—å</button>
      </div>`;
    box.querySelector('[data-save]').onclick=()=>{
      const get=(k)=>box.querySelector(`[data-f="${k}"]`).value;
      CONFIG.products[idx]={
        id:get('id').trim()||p.id, title:get('title').trim()||p.title,
        price:parseInt(get('price'),10)||0, priceText:get('priceText').trim(),
        tag:get('tag').trim(), img:get('img').trim(),
        desc:box.querySelector('[data-f="desc"]').value.trim()
      };
      alert('–¢–æ–≤–∞—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω (–≤ –ø–∞–º—è—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã). –ù–∞–∂–º–∏—Ç–µ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å (localStorage)¬ª, —á—Ç–æ–±—ã –∑–∞–∫—Ä–µ–ø–∏—Ç—å.');
    };
    box.querySelector('[data-del]').onclick=()=>{ if(confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?')){ CONFIG.products.splice(idx,1); renderProducts(); } };
    wrap.appendChild(box);
  });
  $('#add-product').onclick=()=>{ CONFIG.products.push({id:'new-'+Date.now(),title:'–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä',price:0,priceText:'',tag:'',img:'',desc:''}); renderProducts(); };
}

function gatherStore(){
  CONFIG.name=$('#name').value.trim(); CONFIG.tag=$('#tag').value.trim();
  CONFIG.email=$('#email').value.trim(); CONFIG.phone=$('#phone').value.trim();
  CONFIG.inn=$('#inn').value.trim(); CONFIG.ogrn=$('#ogrn').value.trim();
  const tok=$('#tg-token').value.trim(); const chat=$('#tg-chat').value.trim();
  CONFIG.telegram = (tok && chat)? {token:tok, chat_id: Number(chat)||chat} : null;
}

document.getElementById('save').onclick=()=>{ gatherStore(); localStorage.setItem('shopConfig', JSON.stringify(CONFIG)); alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ localStorage. –ó–∞—Ç–µ–º ¬´–≠–∫—Å–ø–æ—Ä—Ç JSON¬ª –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.'); };
document.getElementById('export').onclick=()=>{ gatherStore(); const blob=new Blob([JSON.stringify(CONFIG,null,2)],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='shopConfig.json'; a.click(); };
document.getElementById('import').onchange=async(e)=>{const f=e.target.files[0]; if(!f) return; try{ const j=JSON.parse(await f.text()); CONFIG=j; renderStore(); renderProducts(); alert('–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ. –ù–µ –∑–∞–±—É–¥—å—Ç–µ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å (localStorage)¬ª.'); } catch { alert('–ù–µ–≤–µ—Ä–Ω—ã–π JSON'); } };

(async()=>{ await load(); renderStore(); renderProducts(); })();
</script>
</body>
</html>
