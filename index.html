<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BVB ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω</title>
<link rel="stylesheet" href="style.css" />
<link rel="icon" href="logo.png">
<meta name="description" content="–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ BVB. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞." />
</head>
<body>
<header>
  <div class="container nav">
    <div class="brand">
      <img src="logo.png" alt="BVB" class="brand-logo">
      <div>
        <small>–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞</small>
      </div>
    </div>
    <div class="nav-actions">
      <a class="btn" href="index.html#catalog">–ö–∞—Ç–∞–ª–æ–≥</a>
      <a class="btn" href="wholesale.html">–û–ø—Ç</a>
      <button class="btn icon" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</button>
    </div>
  </div>
</header>

<main class="container">
  <section class="hero">
    <h2>–õ—É—á—à–∏–µ —Ç–æ–≤–∞—Ä—ã –ø–æ —á–µ—Å—Ç–Ω—ã–º —Ü–µ–Ω–∞–º</h2>
    <p>–ú—ã —Ç—â–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–±–∏—Ä–∞–µ–º –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑—ã –ø–æ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–µ. –î–ª—è –æ–ø—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è.</p>
  </section>

  <section class="socials" id="socials">
    <!-- icons will be injected -->
  </section>

  <section id="catalog">
    <div class="grid" id="grid"></div>
  </section>
</main>

<footer class="container">
  ¬© <span id="year"></span> BVB. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
</footer>

<script>
// ===== Theme =====
(function(){
  const saved = localStorage.getItem('theme') || 'dark';
  document.documentElement.setAttribute('data-theme', saved);
  const b = document.getElementById('themeToggle');
  b.textContent = saved === 'dark' ? '‚òÄÔ∏è' : 'üåô';
  b.addEventListener('click',()=>{
    const cur = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', cur);
    localStorage.setItem('theme', cur);
    b.textContent = cur === 'dark' ? '‚òÄÔ∏è' : 'üåô';
  });
})();

// ===== Icons =====
const ICONS = {
  avito: `<svg class="icon-soc" viewBox="0 0 24 24" fill="currentColor"><circle cx="7" cy="7" r="3"/><circle cx="16" cy="6" r="2"/><circle cx="18" cy="14" r="3"/><circle cx="8" cy="17" r="2.5"/></svg>`,
  tg: `<svg class="icon-soc" viewBox="0 0 24 24" fill="currentColor"><path d="M9.036 15.47l-.38 5.36c.54 0 .78-.23 1.06-.51l2.54-2.43 5.25 3.84c.97.53 1.66.25 1.93-.89l3.47-16.27c.31-1.44-.52-2-1.46-1.65L1.05 9.22C-.35 9.78-.33 10.62.81 10.98l5.2 1.62L19.38 5.2c.62-.4 1.18-.18.72.22"/></svg>`,
  wa: `<svg class="icon-soc" viewBox="0 0 24 24" fill="currentColor"><path d="M20 3.9A10 10 0 004 18.6L3 22l3.5-.9A10 10 0 1019.9 4L20 3.9zm-8 16a8 8 0 110-16 8 8 0 010 16z"/></svg>`
};

// ===== Data load with fallback =====
const FALLBACK = {
  socials:[
    {label:"Avito", url:"https://www.avito.ru/", icon:"avito"},
    {label:"Telegram", url:"https://t.me/bvbvbabab", icon:"tg"},
    {label:"WhatsApp", url:"https://wa.me/79831289090", icon:"wa"}
  ],
  products:[
    {
      title:"–õ—ã–∂–Ω—ã–µ —Å–∫—Ä–µ–ø–∫–∏ Fischer",
      slug:"fischer-clips",
      price:99,
      tag:"–•–∏—Ç –ø—Ä–æ–¥–∞–∂",
      desc:"–ü—Ä–æ—á–Ω—ã–µ —Å–∫—Ä–µ–ø–∫–∏ –¥–ª—è –ª—ã–∂ Fischer.",
      avitoUrl:"https://www.avito.ru/",
      images:[
        "https://raw.githubusercontent.com/jonyboev-wq/bvb.github.io/main/IMG_3280.jpeg",
        "https://images.unsplash.com/photo-1549880338-65ddcdfd017b?q=80&w=1600&auto=format&fit=crop"
      ]
    },
    {
      title:"–†—é–∫–∑–∞–∫ –≥–æ—Ä–æ–¥—Å–∫–æ–π",
      slug:"urban-backpack",
      price:2990,
      tag:"–ù–æ–≤–∏–Ω–∫–∞",
      desc:"–õ—ë–≥–∫–∏–π, –∏–∑–Ω–æ—Å–æ—Å—Ç–æ–π–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª, –æ—Ç–¥–µ–ª–µ–Ω–∏–µ 15‚Äù.",
      avitoUrl:"https://www.avito.ru/",
      images:[
        "https://images.unsplash.com/photo-1523419409543-a7cbe5c0f7d4?q=80&w=1600&auto=format&fit=crop"
      ]
    }
  ]
};

async function loadConfig(){
  try{
    const res = await fetch('shopConfig.json',{cache:'no-store'});
    if(!res.ok) throw new Error('no file');
    const data = await res.json();
    return data;
  }catch(e){
    return FALLBACK;
  }
}

function rubl(n){ try{ return new Intl.NumberFormat('ru-RU').format(n) + ' ‚ÇΩ'; }catch(_){ return n + ' ‚ÇΩ'; } }
function el(html){ const d=document.createElement('div'); d.innerHTML=html.trim(); return d.firstChild; }
function slugify(s){ return (s||'').toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9\-]/g,''); }

function renderSocials(items){
  const wrap=document.getElementById('socials'); wrap.innerHTML='';
  items.forEach(s=>{
    const button=el(`<a class="btn small" target="_blank" rel="noopener">${ICONS[s.icon]||''}<span>${s.label}</span></a>`);
    button.href=s.url; wrap.appendChild(button);
  });
}

function renderGrid(items){
  const grid=document.getElementById('grid'); grid.innerHTML='';
  items.forEach(p=>{
    const card=el(`
      <article class="card">
        <a href="product.html?slug=${encodeURIComponent(p.slug || slugify(p.title))}">
          <img class="card-img" src="${(p.images&&p.images[0])||''}" alt="${p.title}" loading="lazy">
          <div class="card-pad">
            <h3 style="margin:0 0 6px">${p.title}</h3>
            ${p.tag? `<div class="badge">${p.tag}</div>`:''}
            <p class="card-pad" style="padding:8px 0 0;margin:0;color:var(--muted)">${p.desc||''}</p>
            <div class="price">${rubl(p.price)}</div>
          </div>
        </a>
        <div class="card-actions">
          <a class="btn small" target="_blank" rel="noopener" href="${p.avitoUrl||'#'}">Avito</a>
          <a class="btn small primary" href="product.html?slug=${encodeURIComponent(p.slug || slugify(p.title))}">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
        </div>
      </article>
    `);
    grid.appendChild(card);
  });
}

(async function init(){
  const cfg = await loadConfig();
  renderSocials(cfg.socials||[]);
  renderGrid(cfg.products||[]);
  document.getElementById('year').textContent=new Date().getFullYear();
})();
</script>
</body>
</html>
