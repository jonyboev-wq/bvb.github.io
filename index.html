<!DOCTYPE html>
<html lang="ru" data-theme="">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BVB ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç</title>
  <meta name="description" content="–ö–∞—Ç–∞–ª–æ–≥, –∫–æ—Ä–∑–∏–Ω–∞, –æ–ø—Ç–æ–≤—ã–µ –∑–∞—è–≤–∫–∏ –∏ –∞–¥–º–∏–Ω–∫–∞ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –ø—Ä–∞–≤–æ–∫." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* LIGHT */
      --bg: #f7fafc;
      --bg-2: #ffffff;
      --card: #ffffff;
      --muted: #5b6776;
      --text: #0b1220;
      --accent: #2563eb;
      --accent-2: #0ea5e9;
      --border: #e5e7eb;
      --shadow: 0 10px 24px rgba(16,24,40,.08);
      --radius: 16px;
      --maxw: 1100px;
      --btn-on-primary: #ffffff;
    }
    /* DARK THEME OVERRIDES */
    [data-theme="dark"]{
      --bg: #0b1220;
      --bg-2: #0e1729;
      --card: #111a2e;
      --muted: #9fb0c8;
      --text: #e6eef9;
      --accent: #3b82f6;
      --accent-2: #38bdf8;
      --border: #1d2a44;
      --shadow: 0 12px 34px rgba(0,0,0,.35);
      --btn-on-primary: #ffffff;
    }

    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{
      font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1000px 600px at 70% -10%, rgba(14,165,233,.15), transparent 60%),
        radial-gradient(900px 500px at -10% 10%, rgba(37,99,235,.10), transparent 60%),
        var(--bg);
      color:var(--text);
      line-height:1.6;
    }
    [data-theme="dark"] body{
      background:
        radial-gradient(1200px 600px at 70% -20%, rgba(59,130,246,.25), transparent 60%),
        radial-gradient(900px 500px at -10% 20%, rgba(56,189,248,.18), transparent 60%),
        var(--bg);
    }
    a{color:var(--text);text-decoration:none}
    .container{max-width:var(--maxw);margin:0 auto;padding:16px}

    header{
      position:sticky;top:0;z-index:30;background:rgba(255,255,255,.85);
      backdrop-filter:saturate(160%) blur(8px);border-bottom:1px solid var(--border)
    }
    [data-theme="dark"] header{ background:rgba(11,18,32,.85); }
    .nav{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:12px;min-width:0}
    .logo{width:40px;height:40px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#1d4ed8);color:#fff;display:grid;place-items:center;box-shadow:var(--shadow)}
    .brand h1{font-size:18px;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .brand p{margin:0;color:var(--muted);font-size:12px}
    .nav-actions{display:flex;gap:8px;align-items:center}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid var(--border);transition:.2s ease;cursor:pointer;background:var(--bg-2);box-shadow:0 1px 0 rgba(16,24,40,.04)}
    .btn:hover{transform:translateY(-1px);box-shadow:var(--shadow)}
    .btn.primary{background:linear-gradient(180deg,var(--accent),#1d4ed8);border:none;color:var(--btn-on-primary)}

    #cart-btn{position:relative}
    #cart-count{position:absolute;top:-6px;right:-6px;background:#22d3ee;color:#0b1220;border-radius:999px;font-size:11px;min-width:18px;height:18px;display:grid;place-items:center;border:1px solid #ccfbf1}

    .hero{padding:36px 0 20px}
    .hero .title{font-size:32px;line-height:1.15;letter-spacing:-.02em;margin:0 0 10px}
    .hero .subtitle{color:var(--muted);font-size:15px;max-width:720px;margin:0 0 18px}
    .hero-cta{display:flex;gap:10px;flex-wrap:wrap}
    .badge{font-size:12px;color:var(--muted)}

    .socials{display:flex;gap:8px;flex-wrap:wrap}
    .socials a{padding:10px 12px;border:1px solid var(--border);border-radius:12px;display:inline-flex;align-items:center;gap:8px;background:var(--card)}

    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow)}
    .card .pad{padding:16px}

    .products{padding:8px 0 28px}
    .product{grid-column:span 12;display:flex;gap:12px;align-items:flex-start;cursor:pointer}
    .product img{width:110px;height:110px;border-radius:12px;object-fit:cover;border:1px solid var(--border);background:#fff}
    .product .meta{flex:1;min-width:0}
    .product h3{margin:0 0 6px;font-size:16px}
    .price{font-weight:700}
    .tag{display:inline-flex;gap:6px;align-items:center;padding:6px 10px;border-radius:999px;border:1px dashed var(--border);font-size:12px;color:var(--muted);background:var(--bg-2)}

    /* Product detail placeholder */
    #product-view{display:none;padding:12px}

    .wholesale{padding:16px}
    form{display:grid;gap:10px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    input, textarea, select{background:var(--bg-2);border:1px solid var(--border);border-radius:12px;padding:12px;color:var(--text);font:inherit}
    textarea{min-height:120px}
    label{font-size:14px;color:var(--muted);display:grid;gap:6px}
    .help{font-size:12px;color:var(--muted)}

    footer{border-top:1px solid var(--border);padding:24px 0;color:var(--muted)}
    .small{font-size:12px}

    .admin-panel{position:fixed;right:16px;bottom:16px;z-index:60;display:none}
    .admin{padding:12px 14px;border-radius:16px;background:var(--bg-2);border:1px solid var(--border);box-shadow:var(--shadow);min-width:320px;max-width:92vw}
    .admin h4{margin:0 0 10px}
    .admin .row2{display:grid;grid-template-columns:1fr 1fr;gap:8px}

    /* CART MODAL (sheet) */
    .modal{position:fixed;inset:0;background:rgba(2,6,23,.28);backdrop-filter:blur(4px);display:none;align-items:flex-end;justify-content:center;z-index:50}
    .modal.open{display:flex}
    .sheet{width:min(760px,92vw);max-height:88vh;background:var(--bg-2);border:1px solid var(--border);border-radius:20px 20px 0 0;box-shadow:var(--shadow);overflow:auto}
    .sheet .head{position:sticky;top:0;background:var(--bg-2);border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;padding:14px 16px}
    .sheet .body{padding:12px}
    .cart-item{display:grid;grid-template-columns:64px 1fr auto;gap:12px;align-items:center;border-bottom:1px dashed var(--border);padding:10px 0}
    .cart-item img{width:64px;height:64px;object-fit:cover;border-radius:12px;border:1px solid var(--border);background:#fff}
    .stepper{display:inline-flex;border:1px solid var(--border);border-radius:10px;overflow:hidden}
    .stepper button{padding:6px 10px;background:var(--bg);border:none;cursor:pointer}
    .stepper input{width:42px;text-align:center;border:none;background:var(--bg-2);color:var(--text)}
    .totals{display:flex;justify-content:space-between;align-items:center;padding:12px;border-top:1px solid var(--border)}
    .muted{color:var(--muted);font-size:13px}

    @media (max-width: 719px){
      .container{padding:12px}
      .hero{padding:22px 0 14px}
      .hero .title{font-size:26px}
      .product img{width:88px;height:88px}
      .row{grid-template-columns:1fr}
      .btn{width:100%}
      .admin{min-width:auto}
    }
    @media (min-width:720px){
      .hero{padding:60px 0 28px}
      .product{grid-column: span 6}
    }
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">
        <div class="logo" aria-hidden="true">üõçÔ∏è</div>
        <div>
          <h1 id="brand-name">BVB</h1>
          <p id="brand-tag">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞</p>
        </div>
      </div>
      <div class="nav-actions">
        <a class="btn ghost" href="#catalog">–ö–∞—Ç–∞–ª–æ–≥</a>
        <a class="btn ghost" href="#wholesale">–û–ø—Ç</a>
        <a class="btn primary" href="#wholesale">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</a>
        <button class="btn" id="theme-toggle" title="–°–≤–µ—Ç–ª–∞—è/—Ç—ë–º–Ω–∞—è —Ç–µ–º–∞">üåô –¢–µ–º–∞</button>
        <a class="btn" id="cart-btn" href="#cart">üß∫ –ö–æ—Ä–∑–∏–Ω–∞ <span id="cart-count">0</span></a>
      </div>
    </div>
  </header>

  <main class="container" id="app">
    <section class="hero" id="home-hero">
      <h2 class="title" id="hero-title">–õ—É—á—à–∏–µ —Ç–æ–≤–∞—Ä—ã –ø–æ —á–µ—Å—Ç–Ω—ã–º —Ü–µ–Ω–∞–º</h2>
      <p class="subtitle" id="hero-sub">–ú—ã —Ç—â–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–±–∏—Ä–∞–µ–º –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑—ã –ø–æ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–µ. –î–ª—è –æ–ø—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è.</p>
      <div class="hero-cta">
        <a class="btn primary" href="#catalog">–°–º–æ—Ç—Ä–µ—Ç—å –∫–∞—Ç–∞–ª–æ–≥</a>
        <a class="btn" href="#wholesale">–û—Å—Ç–∞–≤–∏—Ç—å –æ–ø—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É</a>
      </div>
      <div class="badge" id="contact-line">–ü–∏—à–∏—Ç–µ –Ω–∞–º: <a id="contact-email" href="mailto:sales@example.com">sales@example.com</a> ‚Ä¢ <span id="contact-phone">+7 (900) 000-00-00</span></div>
    </section>

    <section class="card pad" id="home-socials">
      <div class="socials" id="socials"></div>
    </section>

    <section id="catalog" class="products">
      <div class="grid" id="product-grid"></div>
    </section>

    <section id="wholesale" class="card wholesale">
      <h3 style="margin-top:0">–û–ø—Ç–æ–≤–∞—è –∑–∞—è–≤–∫–∞</h3>
      <p class="help">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É ‚Äî –º—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –ø–æ –æ–ø—Ç–æ–≤–æ–π –ø–∞—Ä—Ç–∏–∏.</p>
      <form id="wholesale-form" action="https://formspree.io/f/your-endpoint" method="POST">
        <div class="row">
          <div><label>–í–∞—à–µ –∏–º—è<input required name="name" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤" /></label></div>
          <div><label>Email –¥–ª—è —Å–≤—è–∑–∏<input required type="email" name="email" placeholder="you@example.com" /></label></div>
        </div>
        <div class="row">
          <div><label>–¢–µ–ª–µ—Ñ–æ–Ω<input required name="phone" placeholder="+7 ..." /></label></div>
          <div><label>–ö–æ–º–ø–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)<input name="company" placeholder="–û–û–û &quot;–ü—Ä–∏–º–µ—Ä&quot;" /></label></div>
        </div>
        <div><label>–¢–æ–≤–∞—Ä –∏ –æ–±—ä—ë–º<textarea required name="message" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê—Ä—Ç. 123, 200 —à—Ç. –°—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏ ‚Äî –¥–æ 15 —Å–µ–Ω—Ç—è–±—Ä—è."></textarea></label></div>
        <div class="row">
          <div><label>–ì–æ—Ä–æ–¥/—Ä–µ–≥–∏–æ–Ω<input name="location" placeholder="–ú–æ—Å–∫–≤–∞" /></label></div>
          <div><label>–°–ø–æ—Å–æ–± —Å–≤—è–∑–∏<select name="preferred"><option value="email">Email</option><option value="phone">–¢–µ–ª–µ—Ñ–æ–Ω</option><option value="messenger">–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</option></select></label></div>
        </div>
        <input type="hidden" name="formName" value="Wholesale Lead" />
        <button class="btn primary" type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
        <div id="form-status" class="help"></div>
      </form>
    </section>

    <section id="product-view" class="card pad" style="display:none"></section>
  </main>

  <footer class="container">
    <div class="grid">
      <div class="card pad" style="grid-column:span 12">
        <div class="small">¬© <span id="year"></span> <span id="footer-name">BVB</span>. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã. ‚Ä¢ –ò–ù–ù: <span id="footer-inn">0000000000</span> ‚Ä¢ –û–ì–†–ù: <span id="footer-ogrn">0000000000000</span></div>
      </div>
    </div>
  </footer>

  <!-- CART MODAL -->
  <div id="cart-modal" class="modal" aria-hidden="true">
    <div class="sheet">
      <div class="head">
        <strong>üß∫ –ö–æ—Ä–∑–∏–Ω–∞</strong>
        <div style="display:flex;gap:8px">
          <button class="btn" id="cart-clear">–û—á–∏—Å—Ç–∏—Ç—å</button>
          <button class="btn" id="cart-close">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
      </div>
      <div class="body">
        <div id="cart-list"></div>

        <!-- –§–û–†–ú–ê –û–§–û–†–ú–õ–ï–ù–ò–Ø ‚Äî –í –≠–¢–û–ú –ñ–ï –ú–ï–ù–Æ -->
        <div class="card pad" style="margin:8px 0">
          <div class="row">
            <div><label>–í–∞—à–µ –∏–º—è<input id="order-name" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤" required></label></div>
            <div><label>–¢–µ–ª–µ—Ñ–æ–Ω<input id="order-phone" placeholder="+7 ..." required></label></div>
          </div>
          <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É<textarea id="order-note" placeholder="–ü–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –¥–æ—Å—Ç–∞–≤–∫–µ, —Ü–≤–µ—Ç—É –∏ —Ç.–ø."></textarea></label>
        </div>

        <div class="totals">
          <div>
            <div class="muted">–ö–æ–ª-–≤–æ: <span id="cart-items-count">0</span></div>
            <div><b>–ò—Ç–æ–≥–æ:</b> <span id="cart-total">0 ‚ÇΩ</span></div>
          </div>
          <button class="btn primary" id="cart-checkout">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
        <div class="muted" style="padding:0 12px 12px">–ü–æ—Å–ª–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –º—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ Telegram/–ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.</div>
      </div>
    </div>
  </div>

  <!-- ADMIN -->
  <div class="admin-panel" id="admin-panel">
    <div class="admin">
      <h4>–ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–∞–≤–∫–∏ (–Ω–∞–∂–º–∏—Ç–µ ¬´\¬ª)</h4>
      <div class="row2">
        <input id="inp-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞" />
        <input id="inp-tag" placeholder="–°–ª–æ–≥–∞–Ω" />
      </div>
      <div class="row2" style="margin-top:8px">
        <input id="inp-email" placeholder="Email" />
        <input id="inp-phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" />
      </div>

      <details style="margin-top:10px">
        <summary><b>–¢–æ–≤–∞—Ä—ã</b> ‚Äî –¥–æ–±–∞–≤–∏—Ç—å/–ø—Ä–∞–≤–∏—Ç—å</summary>
        <div id="adm-products" style="display:grid;gap:8px;margin-top:8px"></div>
        <button class="btn" id="adm-add">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
      </details>

      <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap">
        <button class="btn primary" id="save-config">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å (localStorage)</button>
        <button class="btn" id="export-config">–≠–∫—Å–ø–æ—Ä—Ç JSON</button>
        <label class="btn">–ò–º–ø–æ—Ä—Ç JSON <input id="import-config" type="file" accept="application/json" style="display:none"></label>
      </div>
      <div class="help" style="margin-top:6px">–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —É –≤–∞—Å –≤ –±—Ä–∞—É–∑–µ—Ä–µ. –§–∞–π–ª <code>shopConfig.json</code> –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</div>
    </div>
  </div>

  <script>
/* ====== –¢–ï–ú–ê ====== */
const applyTheme = (t)=>{
  const el = document.documentElement;
  if(!t){ t = localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'); }
  el.setAttribute('data-theme', t === 'dark' ? 'dark' : '');
  localStorage.setItem('theme', t);
};
applyTheme();
document.getElementById('theme-toggle').onclick = ()=>{
  const cur = document.documentElement.getAttribute('data-theme')==='dark' ? 'dark' : 'light';
  applyTheme(cur==='dark' ? 'light' : 'dark');
};

/* ====== –ö–û–ù–§–ò–ì: default -> shopConfig.json -> localStorage ====== */
const CONFIG_DEFAULT = {
  name:"BVB", tag:"–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞",
  heroTitle:"–õ—É—á—à–∏–µ —Ç–æ–≤–∞—Ä—ã –ø–æ —á–µ—Å—Ç–Ω—ã–º —Ü–µ–Ω–∞–º",
  heroSub:"–ú—ã —Ç—â–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–±–∏—Ä–∞–µ–º –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑—ã –ø–æ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–µ.",
  email:"sales@example.com", phone:"+7 (983) 128-90-90",
  inn:"0000000000", ogrn:"0000000000000",
  socials:[
    {label:"Avito",    url:"https://www.avito.ru/brands/i184536091?src=sharing", icon:"avito"},
    {label:"Telegram", url:"https://t.me/bvbvbabab", icon:"telegram"},
    {label:"WhatsApp", url:"https://wa.me/79831289090", icon:"whatsapp"}
  ],
  products:[
    { id:"fischer-clips",  title:"–õ—ã–∂–Ω—ã–µ —Å–∫—Ä–µ–ø–∫–∏ Fischer", price:99,  priceText:"–æ—Ç 99 ‚ÇΩ",  tag:"–•–∏—Ç –ø—Ä–æ–¥–∞–∂", img:"IMG_3280.jpeg", desc:"–ü—Ä–æ—á–Ω—ã–µ —Å–∫—Ä–µ–ø–∫–∏ –¥–ª—è –ª—ã–∂ Fischer. –ü–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è." },
    { id:"city-backpack",  title:"–†—é–∫–∑–∞–∫ –≥–æ—Ä–æ–¥—Å–∫–æ–π",        price:2990, priceText:"2 990 ‚ÇΩ", tag:"–ù–æ–≤–∏–Ω–∫–∞",    img:"https://images.unsplash.com/photo-1523419409543-a7cbe5c0f7d4?q=80&w=1200&auto=format&fit=crop", desc:"–õ—ë–≥–∫–∏–π, –∏–∑–Ω–æ—Å–æ—Å—Ç–æ–π–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª, –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è –Ω–æ—É—Ç–±—É–∫–∞ 15\"" },
    { id:"bt-headphones",  title:"–ù–∞—É—à–Ω–∏–∫–∏ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ",   price:3490, priceText:"3 490 ‚ÇΩ", tag:"–¢–æ–ø-–≤—ã–±–æ—Ä",  img:"https://images.unsplash.com/photo-1518442400540-92f54f2d1f11?q=80&w=1200&auto=format&fit=crop", desc:"–®—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ, 30 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã, –±—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞." },
    { id:"fleece-blanket", title:"–ü–ª–µ–¥ —Ñ–ª–∏—Å–æ–≤—ã–π",           price:790,  priceText:"790 ‚ÇΩ",   tag:"–¢—ë–ø–ª—ã–π —É—é—Ç", img:"https://images.unsplash.com/photo-1519710164239-da123dc03ef4?q=80&w=1200&auto=format&fit=crop", desc:"–ú—è–≥–∫–∏–π, –≥–∏–ø–æ–∞–ª–ª–µ—Ä–≥–µ–Ω–Ω—ã–π, 130√ó170 —Å–º. –†–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞." }
  ]
};

let CONFIG = JSON.parse(JSON.stringify(CONFIG_DEFAULT));

async function loadRemoteConfig(){
  try{
    const res = await fetch('shopConfig.json', {cache:'no-store'});
    if(res.ok){
      const remote = await res.json();
      CONFIG = Object.assign({}, CONFIG, remote);
      if(remote.products) CONFIG.products = remote.products;
      if(remote.socials)  CONFIG.socials  = remote.socials;
    }
  }catch(e){ /* –Ω–µ—Ç —Ñ–∞–π–ª–∞ ‚Äî –æ–∫ */ }
  const local = localStorage.getItem('shopConfig');
  if(local){
    try{
      const obj = JSON.parse(local);
      CONFIG = Object.assign({}, CONFIG, obj);
      if(obj.products) CONFIG.products = obj.products;
      if(obj.socials)  CONFIG.socials  = obj.socials;
    }catch(e){}
  }
}

/* ====== –ö–û–†–ó–ò–ù–ê ====== */
const CART_KEY='shopCart';
const cart = JSON.parse(localStorage.getItem(CART_KEY)||'[]');
const fmt=(n)=> new Intl.NumberFormat('ru-RU').format(n)+' ‚ÇΩ';
function saveCart(){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); renderCartBadge(); renderCartModal(); }
function addToCart(item){ const i=cart.findIndex(x=>x.id===item.id); if(i>-1){cart[i].qty+=item.qty;} else {cart.push(item);} saveCart(); }
function cartCount(){ return cart.reduce((s,i)=>s+i.qty,0); }
function cartTotal(){ return cart.reduce((s,i)=>s+i.qty*i.price,0); }
function renderCartBadge(){ const c=document.getElementById('cart-count'); if(c) c.textContent = cartCount(); }
function clearCart(){ cart.length=0; saveCart(); }
function openCart(){ document.getElementById('cart-modal').classList.add('open'); renderCartModal(); }
function closeCart(){ document.getElementById('cart-modal').classList.remove('open'); }
document.getElementById('cart-btn').addEventListener('click',(e)=>{e.preventDefault(); openCart();});
document.getElementById('cart-close').onclick=closeCart;
document.getElementById('cart-clear').onclick=()=>{ if(confirm('–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É?')) clearCart(); };

function renderCartModal(){
  const list = document.getElementById('cart-list');
  if(!list) return;
  if(!cart.length){
    list.innerHTML = `<div class="muted" style="padding:12px">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞.</div>`;
  }else{
    list.innerHTML = cart.map(it=>`
      <div class="cart-item">
        <img src="${it.img}" alt="" onerror="this.onerror=null;this.src='https://via.placeholder.com/120x120?text=–§–æ—Ç–æ'">
        <div>
          <div style="font-weight:600">${it.title}</div>
          <div class="muted">${fmt(it.price)} –∑–∞ —à—Ç.</div>
        </div>
        <div style="display:flex;align-items:center;gap:8px">
          <div class="stepper">
            <button data-dec="${it.id}" aria-label="–ú–∏–Ω—É—Å">‚àí</button>
            <input value="${it.qty}" readonly>
            <button data-inc="${it.id}" aria-label="–ü–ª—é—Å">+</button>
          </div>
          <button class="btn" data-del="${it.id}" aria-label="–£–¥–∞–ª–∏—Ç—å">‚úï</button>
        </div>
      </div>
    `).join('');
  }
  document.getElementById('cart-items-count').textContent = cartCount();
  document.getElementById('cart-total').textContent = fmt(cartTotal());
  list.querySelectorAll('[data-inc]').forEach(b=>b.onclick=()=>{const i=cart.findIndex(x=>x.id===b.dataset.inc); if(i>-1){cart[i].qty++; saveCart();}});
  list.querySelectorAll('[data-dec]').forEach(b=>b.onclick=()=>{const i=cart.findIndex(x=>x.id===b.dataset.dec); if(i>-1){cart[i].qty=Math.max(1,cart[i].qty-1); saveCart();}});
  list.querySelectorAll('[data-del]').forEach(b=>b.onclick=()=>{const i=cart.findIndex(x=>x.id===b.dataset.del); if(i>-1){cart.splice(i,1); saveCart();}});
}

/* ====== TELEGRAM CHECKOUT (–±–µ–∑ prompt) ====== */
const TG = { token:"8331334111:AAGgH9i3H76H_TEhMGbNhySDmf-aXlYteTM", chat_id:5223524937 };
async function tgSend(text){
  try{
    const r=await fetch(`https://api.telegram.org/bot${TG.token}/sendMessage`,{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({chat_id:TG.chat_id,text,parse_mode:"HTML"})
    });
    if(!r.ok) alert('–û—à–∏–±–∫–∞ Telegram: '+await r.text());
  }catch(e){ alert('–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ Telegram'); }
}
document.getElementById('cart-checkout').onclick = async ()=>{
  if(!cart.length){ alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞.'); return; }
  const name = document.getElementById('order-name').value.trim();
  const phone= document.getElementById('order-phone').value.trim();
  const note = document.getElementById('order-note').value.trim();
  if(!name || !phone){ alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω.'); return; }
  const lines = cart.map((it,i)=> `${i+1}. ${it.title} ‚Äî ${fmt(it.price)} √ó ${it.qty}`).join('\n');
  const text = `<b>–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</b>\n${lines}\n\n<b>–ò—Ç–æ–≥–æ:</b> ${fmt(cartTotal())}\n\n–ò–º—è: ${name}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}${note?'\n–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: '+note:''}`;
  await tgSend(text);
  clearCart(); closeCart();
  alert('–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.');
};

/* ====== –•–ï–õ–ü–ï–†–´ ====== */
const $ = (s,el=document)=>el.querySelector(s);
function iconSVG(name){
  const icons = {
    telegram:'<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9.036 15.47l-.38 5.36c.542 0 .776-.233 1.056-.512l2.536-2.43 5.256 3.84c.964.533 1.654.252 1.916-.89l3.472-16.27c.308-1.44-.52-2.004-1.46-1.654L1.05 9.22C-.346 9.78-.324 10.62.81 10.98l5.2 1.62L19.384 5.2c.616-.404 1.178-.18.716.224"/></svg>',
    whatsapp:'<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20 3.9A10 10 0 004 18.6L3 22l3.5-.9A10 10 0 1019.9 4L20 3.9zm-8 16a8 8 0 110-16 8 8 0 010 16zm4.6-5.9c-.3-.1-1.7-.8-1.9-.9-.3-.1-.5-.1-.7.2s-.8.9-.9 1-.3.1-.6 0a6.8 6.8 0 01-2-1.2 7.4 7.4 0 01-1.4-1.7c-.1-.3 0-.5.1-.6l.3-.4c.1-.1.1-.3 0-.5-.1-.1-.7-1.8-.9-2.4-.2-.6-.5-.5-.7-.5h-.6c-.2 0-.5.1-.7.3-.8.8-1.1 1.9-1.1 3 0 1.8 1.3 3.5 1.5 3.7.2.3 2.6 4.1 6.4 5.6 3.8 1.5 3.8 1 4.5.9.7-.1 2.3-.9 2.6-1.8.3-.9.3-1.7.2-1.8-.1-.1-.3-.2-.6-.3z"/></svg>',
    avito:'<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><circle cx="7" cy="7" r="3"/><circle cx="16" cy="6" r="2"/><circle cx="18" cy="14" r="3"/><circle cx="8" cy="17" r="2.5"/></svg>'
  };
  return icons[name] || '';
}

/* ====== –†–ï–ù–î–ï–†–´ ====== */
function renderHome(){
  $('#brand-name').textContent = CONFIG.name;
  $('#footer-name').textContent = CONFIG.name;
  $('#brand-tag').textContent = CONFIG.tag;
  $('#hero-title').textContent = CONFIG.heroTitle;
  $('#hero-sub').textContent = CONFIG.heroSub;
  $('#contact-email').textContent = CONFIG.email;
  $('#contact-email').href = `mailto:${CONFIG.email}`;
  $('#contact-phone').textContent = CONFIG.phone;
  $('#footer-inn').textContent = CONFIG.inn || "0000000000";
  $('#footer-ogrn').textContent = CONFIG.ogrn || "0000000000000";

  const socialsWrap = $('#socials'); socialsWrap.innerHTML='';
  CONFIG.socials.forEach(s=>{
    const a=document.createElement('a'); a.href=s.url; a.target='_blank'; a.rel='noopener';
    a.innerHTML = `${iconSVG(s.icon)} <span>${s.label}</span>`;
    socialsWrap.appendChild(a);
  });

  const grid = $('#product-grid'); grid.innerHTML='';
  CONFIG.products.forEach(p=>{
    const card = document.createElement('article');
    card.className='card pad product';
    card.innerHTML = `
      <img src="${p.img}" alt="${p.title}"
           onerror="this.onerror=null;this.src='https://via.placeholder.com/220x220?text=–§–æ—Ç–æ'">
      <div class="meta">
        <h3>${p.title}</h3>
        <div class="tag">${p.tag||''}</div>
        <p class="help" style="margin:6px 0 10px">${p.desc||''}</p>
        <div class="price">${p.priceText || fmt(p.price||0)}</div>
        <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn primary" data-add="${p.id}">–í –∫–æ—Ä–∑–∏–Ω—É</button>
          <a class="btn" href="product.html?id=${encodeURIComponent(p.id)}" target="_self">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
        </div>
      </div>
    `;
    card.addEventListener('click',(e)=>{
      const btn=e.target.closest('[data-add]');
      if(btn){ e.stopPropagation(); addToCart({ id:p.id, title:p.title, price:p.price||0, img:p.img, qty:1 }); return; }
      location.href = `product.html?id=${encodeURIComponent(p.id)}`;
    });
    grid.appendChild(card);
  });

  // –ø–æ–ª—è –∞–¥–º–∏–Ω–∫–∏
  $('#inp-name').value = CONFIG.name;
  $('#inp-tag').value = CONFIG.tag;
  $('#inp-email').value = CONFIG.email;
  $('#inp-phone').value = CONFIG.phone;
  renderAdmProducts();
}

/* ====== –ê–î–ú–ò–ù–ö–ê ====== */
function renderAdmProducts(){
  const wrap = $('#adm-products'); if(!wrap) return;
  wrap.innerHTML='';
  CONFIG.products.forEach((p,idx)=>{
    const row=document.createElement('div');
    row.className='card pad';
    row.innerHTML=`
      <div class="row2">
        <input data-f="title" value="${p.title||''}" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
        <input data-f="id" value="${p.id||('id-'+idx)}" placeholder="ID (–¥–ª—è —Å—Å—ã–ª–∫–∏)">
      </div>
      <div class="row2" style="margin-top:8px">
        <input data-f="price" value="${p.price||0}" type="number" placeholder="–¶–µ–Ω–∞, ‚ÇΩ">
        <input data-f="priceText" value="${p.priceText||''}" placeholder="–¶–µ–Ω–∞ (—Ç–µ–∫—Å—Ç, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)">
      </div>
      <div class="row2" style="margin-top:8px">
        <input data-f="tag" value="${p.tag||''}" placeholder="–¢—ç–≥ (–±–µ–π–¥–∂)">
        <input data-f="img" value="${p.img||''}" placeholder="URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
      </div>
      <div style="margin-top:8px">
        <textarea data-f="desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ">${p.desc||''}</textarea>
      </div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" data-save>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="btn" data-del>–£–¥–∞–ª–∏—Ç—å</button>
      </div>
    `;
    row.querySelector('[data-save]').onclick=()=>{
      const get=(k)=>row.querySelector(`[data-f="${k}"]`).value;
      CONFIG.products[idx]={
        id:get('id').trim()||p.id,
        title:get('title').trim()||p.title,
        price:parseInt(get('price'),10)||p.price||0,
        priceText:get('priceText').trim()||"",
        tag:get('tag').trim()||"",
        img:get('img').trim()||p.img||'',
        desc:row.querySelector('[data-f="desc"]').value.trim()||""
      };
      localStorage.setItem('shopConfig', JSON.stringify(CONFIG));
      alert('–¢–æ–≤–∞—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω'); renderHome();
    };
    row.querySelector('[data-del]').onclick=()=>{
      if(confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')){ CONFIG.products.splice(idx,1); localStorage.setItem('shopConfig', JSON.stringify(CONFIG)); renderAdmProducts(); renderHome(); }
    };
    wrap.appendChild(row);
  });
}
document.getElementById('adm-add').addEventListener('click', ()=>{
  CONFIG.products.push({ id:'new-'+Date.now(), title:'–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä', price:0, priceText:'0 ‚ÇΩ', tag:'', img:'', desc:'' });
  renderAdmProducts(); renderHome();
});

document.addEventListener('keydown',(e)=>{
  if(e.key==='\\'){
    const panel=$('#admin-panel');
    const isVisible=getComputedStyle(panel).display!=='none';
    panel.style.display=isVisible?'none':'block';
  }
});
document.getElementById('save-config').addEventListener('click', ()=>{
  const next = {
    ...CONFIG,
    name: $('#inp-name').value.trim() || CONFIG.name,
    tag: $('#inp-tag').value.trim() || CONFIG.tag,
    email: $('#inp-email').value.trim() || CONFIG.email,
    phone: $('#inp-phone').value.trim() || CONFIG.phone,
  };
  localStorage.setItem('shopConfig', JSON.stringify(next));
  location.reload();
});
document.getElementById('export-config').onclick = ()=>{
  const blob = new Blob([JSON.stringify(CONFIG,null,2)], {type:'application/json'});
  const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='shopConfig.json'; a.click();
};
document.getElementById('import-config').onchange = async (e)=>{
  const f=e.target.files[0]; if(!f) return;
  const text=await f.text();
  try{ const obj=JSON.parse(text); localStorage.setItem('shopConfig', JSON.stringify(obj)); alert('–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—é.'); location.reload(); }
  catch{ alert('–ù–µ–≤–µ—Ä–Ω—ã–π JSON'); }
};

/* ====== INIT ====== */
(async ()=>{
  await loadRemoteConfig();
  document.getElementById('year').textContent = new Date().getFullYear();
  renderCartBadge();
  renderHome();
})();
  </script>
</body>
</html>
