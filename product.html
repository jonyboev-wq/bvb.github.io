
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–¢–æ–≤–∞—Ä ‚Äî BVB</title>
  <link rel="icon" href="logo.png">
  <link rel="stylesheet" href="style.css">
  <script defer src="common.js"></script>
</head>
<body>
<header>
  <div class="container nav">
    <div class="brand">
      <a href="index.html"><img src="logo.png" alt="BVB"></a>
      <div>
        <h1 id="brand-name">BVB</h1>
        <p class="tag" id="brand-tag">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞</p>
      </div>
    </div>
    <div class="nav-actions">
      <a class="btn" href="index.html#catalog">–ö–∞—Ç–∞–ª–æ–≥</a>
      <a class="btn" href="wholesale.html">–û–ø—Ç</a>
      <button class="btn icon-btn" id="theme-btn" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"><span id="theme-icon" class="icon">üåô</span></button>
      <a class="btn" id="cart-btn" href="#" onclick="openCart();return false;">üß∫ <span id="cart-count">0</span></a>
    </div>
  </div>
</header>

<main class="container">
  <section id="product" class="card pad"></section>
</main>

<footer class="container">
  <div class="small">¬© <span id="year"></span> BVB</div>
</footer>

<script>
applyTheme(localStorage.getItem(THEME_KEY)||'light'); updateThemeIcon(); updateCartCount();
document.getElementById('theme-btn').addEventListener('click', toggleTheme);
document.getElementById('year').textContent = new Date().getFullYear();

function getParam(name){ const u=new URLSearchParams(location.search); return u.get(name)||''; }

function render(prod){
  const el = document.getElementById('product');
  if(!prod){ el.innerHTML='<p>–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω.</p>'; return; }
  const gal = (prod.gallery||[]).map(src=>`<img src="${src}" style="width:88px;height:88px;border-radius:10px;border:1px solid var(--border);object-fit:cover">`).join('');
  const specs = prod.attributes ? Object.entries(prod.attributes).map(([k,v])=>`<div class="small"><b>${k}:</b> ${v}</div>`).join('') : '';
  el.innerHTML = `
    <div class="grid" style="gap:16px">
      <div class="card" style="grid-column:span 6; padding:8px; display:grid; place-items:center">
        <img src="${prod.img}" alt="${prod.title}" style="width:100%; max-height:420px; object-fit:cover; border-radius:12px; border:1px solid var(--border)">
        <div style="display:flex; gap:8px; margin-top:10px">${gal}</div>
      </div>
      <div style="grid-column:span 6">
        <h2 style="margin-top:0">${prod.title}</h2>
        <div class="tag" style="margin-bottom:8px">${prod.tag||''}</div>
        <div class="price" style="font-size:22px">${(prod.price||0).toLocaleString('ru-RU')} ‚ÇΩ</div>
        ${prod.oldPrice ? `<div class="small" style="text-decoration:line-through; color:var(--muted)">${prod.oldPrice.toLocaleString('ru-RU')} ‚ÇΩ</div>` : ''}
        <p style="margin:10px 0">${prod.desc||''}</p>
        ${specs}
        <div style="display:flex; gap:8px; margin-top:12px">
          <button class="btn" onclick="addToCart({title:prod.title, price:prod.price, img:prod.img, sku:prod.sku||prod.slug})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
          ${prod.avitoUrl ? `<a class="btn" href="${prod.avitoUrl}" target="_blank" rel="noopener">–ù–∞ –ê–≤–∏—Ç–æ</a>` : ''}
        </div>
      </div>
    </div>`;
}

loadConfig().then(cfg=>{
  const slug = getParam('slug');
  const prod = cfg.products.find(p=>(p.slug||slugify(p.title))===slug);
  document.getElementById('brand-name').textContent = cfg.name;
  render(prod);
}).catch(err=>console.error(err));
</script>
</body>
</html>
